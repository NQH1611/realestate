<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Real Estate</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css">
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css" />
    <link rel="stylesheet" href="./css/style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.2/jquery.min.js"></script>
</head>

<body>
    <nav class="navbar navbar-expand-sm sticky-top  navbar-light bg-light">
        <div class="container">
            <a class="navbar-brand" href="#"><img src="./image/logo.svg" alt=""></a>
            <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse"
                data-target="#navbar1">
                <span class="navbar-toggler-icon"></span>
            </button>
            <!-- <div class="d-md-flex d-block flex-row mx-md-auto mx-0"> -->
            <div class="collapse navbar-collapse mr-auto" id="navbar1">
                <ul class="navbar-nav mx-auto">
                    <li class="nav-item ">
                        <a class="nav-link text-bold" href="./index.html">HOME</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link text-bold" href="./about.html">ABOUT</a>
                    </li>
                    <li class="nav-item active">
                        <a class="nav-link text-bold" href="./properties.html">PROPERTIES</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link text-bold" href="./post.html">POST</a>
                    </li>
                </ul>
                <ul class="navbar-nav ml-auto">
                    <li class="nav-item active">
                        <a class="nav-link" href="./login.html"><button
                                class="btn btn-success btn-login">LOGIN</button></a>
                    </li>
                </ul>
            </div>
            <!-- </div> -->
        </div>
    </nav>
    <div class="container mt-5">
        <div class="col-sm-12 border border-secondary rounded pt-3 pb-3">
            <div class="row">
                <div class="col-sm-10 row text-center m-auto ">
                    <div class="col-sm-3"><select name="" class="form-control mt-2 mb-2" id="selectProvince">
                            <option value="-1"> --- Province --- </option>
                        </select></div>
                    <div class="col-sm-3"><select name="" class="form-control mt-2 mb-2" id="selectDistrict">
                            <option value="-1"> --- District --- </option>
                        </select></div>
                    <div class="col-sm-3"><select name="" class="form-control mt-2 mb-2" id="selectWard">
                            <option value="-1"> --- Ward --- </option>
                        </select></div>
                    <div class="col-sm-3"><select name="" class="form-control mt-2 mb-2" id="selectPrice">
                            <option value="0"> --- Price --- </option>
                            <option value="1"> 0 -> 500.000.000 </option>
                            <option value="2"> 500.000.000 -> 1.500.000.000 </option>
                            <option value="3"> 1.500.000.000 -> 4.500.000.000 </option>
                            <option value="4"> > 4.500.000.000 </option>
                        </select></div>
                </div>
                <div class="col-sm-2"><input type="button" value="Search" class="btn btn-success btn-find w-100 mt-2 mb-2"></div>
            </div>
        </div>
        <div class="d-flex flex-row-reverse mt-3">
            <select name="" id="" class="form-control sort w-25">
                <option value="0">Sort</option>
                <option value="1">Tăng dần</option>
                <option value="2">Giảm dần</option>
            </select>

        </div>
    </div>

    <div class="container">

        <div class="row full-project">

        </div>
    </div>
    <div class="container-fluid mt-5">
        <div class="container">
            <div class="col-sm-12 row">
                <div class="col-sm-3">
                    <img src="./image/logo.svg" class="mt-3" width="50%" alt="">
                    <p class="mt-3">Properties are most budget friendly so you have are find opportunity is main
                        responsibility to clients</p>
                    <p class=" mt-5" style="font-size: 10px;">© CodeCarnival. All Rights Reserved - Privacy Policy</p>
                </div>
                <div class="col-sm-3 text-center">
                    <h4>Information</h4>
                    <p>About us</p>
                    <p>Properties</p>
                    <p>Careers</p>
                    <p>Payment</p>
                    <p>Blog Post</p>
                </div>
                <div class="col-sm-3 text-center">
                    <h4>Support.</h4>
                    <p>Add Property</p>
                    <p>Terms & Conditions</p>
                    <p>Help line</p>
                    <p>Our Agents</p>
                    <p>features</p>
                </div>
                <div class="col-sm-3 text-center">
                    <h4>Address.</h4>
                    <p>2104 Charmaine Lane Amarillo, New York</p>
                    <div class="col-sm-12">
                        <div class="row">
                            <button class="btn mr-3" style="width: 60px; height: 50px;"><i class="fab fa-facebook"
                                    aria-hidden="true"></i></button>
                            &nbsp;
                            <button class="btn mr-3 " style="width: 60px; height: 50px;"><i class="fab fa-twitter"
                                    aria-hidden="true"></i></button>
                            &nbsp;
                            <button class="btn" style="width: 60px; height: 50px;"><i class="fab fa-instagram"
                                    aria-hidden="true"></i></button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <script>
            $(document).ready(function () {
                if (sessionStorage.getItem("token") == "") {
                    $(".btn-login").html("LOGIN")
                } else {
                    $(".btn-login").html(sessionStorage.getItem("username"))
                }
                $(".card").find("div").click(function () {
                    window.location.href = "http://127.0.0.1:5500/project.html"
                })
                $(".card").find("img").click(function () {
                    window.location.href = "http://127.0.0.1:5500/project.html"
                })
                apiCallProvince()
                $("#selectProvince").on("change", function () {
                    var province = $(this).find(":checked").val()
                    apiCallDistrict(province)
                })
                const URL = "http://localhost:8080/projects"
                callApiProject(URL)
                $(".sort").on("change", function () {
                    var sort = $(this).find(":checked").val()
                    console.log(sort)
                    if(sort == 2){
                        const URL1 = "http://localhost:8080/ascprojects"
                        callApiProject(URL1)
                    }
                    if(sort == 1){
                        const URL2 = "http://localhost:8080/descprojects"
                        callApiProject(URL2)
                    }
                    if(sort == 0){
                        const URL = "http://localhost:8080/projects"
                        callApiProject(URL)
                    }
                })
                $("#selectDistrict").on("change", function () {
                    var district = $(this).find(":checked").val()
                    apiCallWard(district)
                })
                $(".btn-find").on("click", function(){
                    var province = $("#selectProvince").val()
                    var district = $("#selectDistrict").val()
                    var ward = $("#selectWard").val()
                    var price = $("#selectPrice").val()
                    var URLSearch = `http://localhost:8080/searchproject/${province}/${district}/${ward}/${price}`
                    callApiProject(URLSearch)
                })
            })
            function callApiProject(paramURL){
                $(".full-project").html("")
                $.ajax({
                    type: "get",
                    url: paramURL,
                    dataType: "json",
                    success: function (response) {
                        for (var bIndex in response) {
                            if (response[bIndex].status == 1) {
                                var price = response[bIndex].price
                                price = price.toLocaleString('vi', { style: 'currency', currency: 'VND' })
                                var html = `<div class="card ml-4 mt-4" style="width: 22rem;">
                                <a href="./project.html?id=${response[bIndex].id}"><img src="./image/${response[bIndex].photo}" class="card-img-top" alt="..."></a>
                                <div class="card-body pb-0">
                                    <h5 class="card-title" style="height: 40px; font-size: 26px;">${response[bIndex].name}</h5>
                                    <p class="card-text">
                                    <div>ADDRESS: ${response[bIndex].address}</div>

                                    
                                    </p>
                                </div>
                                <div class="card-footer ">
                                    <div class="row">
                                        <div class="col-sm-8 text-left pl-4 mt-2 font-name-teacher">
                                            <p>PRICE: ${price}</p>
                                        </div>
                                        <div class="col-sm-2 mt-2 ml-auto"><i class="far fa-bookmark"></i></div>
                                    </div>
                                </div>
                            </div>
                        </div>`
                                $(".full-project").append(html)
                            }

                        }
                    }
                });
            }
            function apiCallProvince() {
                $.ajax({
                    type: "GET",
                    url: "http://localhost:8080/province",
                    dataType: "json",
                    success: function (response) {
                        for (var bIndex in response) {
                            var html = `<option value="${response[bIndex].id}"> ${response[bIndex].name}</option>`
                            $("#selectProvince").append(html)
                        }
                    }
                });
            }
            function apiCallDistrict(paramProvince) {
                $("#selectDistrict").html(`<option value="-1"> --- District --- <option>`)
                $.ajax({
                    type: "GET",
                    url: "http://localhost:8080/district/" + paramProvince,
                    dataType: "json",
                    success: function (response) {
                        $("#selectDistrict").removeAttr("disabled")
                        for (var bIndex in response) {
                            var html = `<option value="${response[bIndex].id}"> ${response[bIndex].name}</option>`
                            $("#selectDistrict").append(html)
                        }
                    }
                });
            }
            function apiCallWard(paramDistrict) {
                $("#selectWard").html(`<option value="-1"> --- Ward --- <option>`)
                $.ajax({
                    type: "GET",
                    url: "http://localhost:8080/ward/" + paramDistrict,
                    dataType: "json",
                    success: function (response) {
                        $("#selectWard").removeAttr("disabled")
                        for (var bIndex in response) {
                            var html = `<option value="${response[bIndex].id}"> ${response[bIndex].name}</option>`
                            $("#selectWard").append(html)
                        }
                    }
                });
            }
        </script>
</body>

</html>